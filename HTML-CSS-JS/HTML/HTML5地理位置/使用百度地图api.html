<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>使用百度地图api</title>
    <style>
    #lzxMap {
        width: 500px;
        height: 500px;
        border: 1px solid crimson;
    }
    </style>
    <script src="http://api.map.baidu.com/api?v=1.4">
    </script>
</head>

<body>
    <input type="button" value="获取地理位置">
    <div id="lzxMap"></div>
    <script>
    var oBtn = document.querySelector('input');
    var oDiv = document.querySelector('#lzxMap');
    oBtn.onclick = function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(geoSuccess);
        } else {
            oDiv.innerText = '你的浏览器太老了，不支持地理位置功能';
        }

    };

    function geoSuccess(position) {
        var map = new BMap.Map('lzxMap');
        var lzxPoint = new BMap.Point(position.coords.longitude, position.coords.latitude);
        map.centerAndZoom(lzxPoint, 20);
        //图标
        var lzxIcon = new BMap.Icon("sakura.jpg", new BMap.Size(20, 20));
        //marker
        var lzxMarker = new BMap.Marker(lzxPoint, {
            icon: lzxIcon
        });
        map.addOverlay(lzxMarker);
        // 信息窗口
        var lzxInfoWindow = new BMap.InfoWindow("这里是详细信息~~滴滴答滴答", {
            width: 200, // 信息窗口宽度
            height: 60, // 信息窗口高度
            title: "~~这里是title喔~~" // 信息窗口标题
        });
        map.openInfoWindow(lzxInfoWindow, lzxPoint);
        //定位当前城市
        var myCity = new BMap.LocalCity();
        myCity.get(function(result) {
            var cityName = result.name;
            alert("当前定位城市:" + cityName);
        });
    }
    </script>
</body>

</html>
